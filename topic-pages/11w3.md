## üõ°Ô∏è Part 3: Ubuntu-Wazuh VM  ‚Äî Adapter Settings & LAN IP Configuration

### üìå Introduction

    In this part of the lab, we‚Äôll configure the Ubuntu Wazuh VM with two network adapters, similar to the pfSense setup: NAT for external access, including port forwarding to allow updates and remote management, and Internal Network for LAN connectivity, enabling communication with pfSense, Kali Linux, and other lab VMs. This setup ensures that Wazuh can function as a central monitoring and security server within the home lab environment while remaining accessible for management tasks.

### üí° Tip: Keep ChatGPT Handy

    If Ubuntu drops connection or refuses to apply Netplan config changes, here's a sample prompt for ChatGPT:  
    
    "Ubuntu VM won't take static IP 192.168.10.4 via Netplan, here's my /etc/netplan/50-cloud-init.yaml. Can you fix indentation or syntax issues?"

---

### üîπ Step 1: Ubuntu Wazuh Adapters [1 (WAN) & 2 (LAN)] Configuration

1. **Power off** the Ubuntu Wazuh VM.

2. Navigate to **Settings** ‚Üí **Network**.

- **Adapter 1 (WAN):**

  - Check **Enable Network Adapter** [‚úì]
  - Attached to: **NAT**
  - Promiscuous Mode: **Allow All**
  - Click **Port Forwarding**

![](../images/11u3-images/1.png)

3. Click **'+'** (Add button) to add Port Forwarding Rules:

- Set the Following (we will set 3 three rules):

  - Name: **Wazuh-API**
  - Protocol: **TCP**
  - Host IP: **(leave blank)**
  - Host Port: **5500**
  - Guest IP: **192.168.10.4**
  - Guest Port: **5500**

- Set the Following:

  - Name: **Wazuh-Dashboard**
  - Protocol: **TCP**
  - Host IP: **(leave blank)**
  - Host Port: **443**
  - Guest IP: **192.168.10.4**
  - Guest Port: **443**

- Set the Following:

  - Name: **Wazuh-API**
  - Protocol: **TCP**
  - Host IP: **(leave blank)**
  - Host Port: **5500**
  - Guest IP: **192.168.10.4**
  - Guest Port: **5500**

4. Click **OK**
	
![](../images/11u3-images/2.png)

- **Adapter 2 (LAN):**

  - Check **Enable Network Adapter** [‚úì]
  - Attached to: **Internal Network**
  - Name: **LabNet** (or any name you want, just make sure all VMs have the same network name)
  - Promiscuous Mode: **Allow All**
  - Click **OK** to save settings and exit.  

![](../images/11u3-images/3.png)

---

### üîπ Step 2: Configure LAN Static IP Address

1. Boot Ubuntu Wazuh VM

2. Edit the Netplan config file:<br>
**Note:** `sudo su` (elevates user privilege to ‚Äòroot‚Äô for config file access)
            `cd /`  (change directory to ‚Äòroot‚Äô directory).
            `cd /etc/netplan`  (change directory from ‚Äòroot‚Äô to ‚Äònetplan‚Äô directory).
            `ls` (lists files under ‚Äònetplan‚Äô directory and check if config file exists).
            `nano 50-cloud-init.yaml`  (opens the ‚Äô50-cloud-init.yaml‚Äô file to be edited).
            
            
        Run commands:

            `sudo su`
            - Enter password when prompted: <your_Ubuntu_VM_password> 
            `cd /`
            `cd /etc/netplan`
            `ls` 
            `nano 50-cloud-init.yaml`

![](../images/11u3-images/4.png)

3. Add the following configurations:

	**Important Note**: Proper indentations should be observed when adding this configuration. Incorrect indentations will result to ERRORS! Check your indentations carefully!
```markdown
Insert this configuration in the config file.
WATCH THE INDENTATION! WRONG INDENTATIONS WILL CAUSE ERROR!

network:
  version: 2
  ethernets:
    enp0s3:
      dhcp4: true
    enp0s8:
      dhcp4: false
      addresses:
        - 192.168.10.4/24
      routes:
        - to: 0.0.0.0/0
          via: 192.168.10.1
      nameservers:
        addresses:
          - 1.1.1.1
          - 8.8.8.8
```

4. To save configuration and close editor: `ctrl + x`, then press `Enter`, then press `y`

![](../images/11u3-images/5.png)

5. Apply config and check for connectivity:

    Run commands:
                
    `sudo netplan apply`

    `ping -c 4 192.168.10.1`

    `ping -c 4 google.com`

![](../images/11u3-images/6.png) 

6. Check IP address:

    Run command:
    
    `ip a`

‚Ä¢	The Static IP Address of Ubuntu-Wazuh is now set to **192.168.10.4**

![](../images/11u3-images/7.png)

‚Ä¢	The Wazuh-Dashboard can now be access by opening the following URL on Kali Linux or Windows10 VM browser after their Adapter setup:
	
	https://192.168.10.4:443

![](../images/11u3-images/8.png)

‚Ä¢	Now you have a system that allows you to monitor activities and identify vulnerabilities on both the Kali Linux and Windows 10 VM endpoints. This setup also gives you the flexibility to experiment with different areas of the SIEM, such as log collection, alert creation, and incident response workflows.

![](../images/11u3-images/9.png)

---
üëâ [Part 2.c: Configure Network Settings for Windows 10 VM](/12w4.md) 

üîô [Back to Home](../index.md) 
